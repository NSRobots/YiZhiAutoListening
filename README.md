# YiZhiAutoListening
易智自动化操作脚本软件的按键监控并记录的测试，Java语言实现

===============================================================================================

运行：在.jar包的当前目录下，命令行输入"java -jar test4Listening-1.0-SNAPSHOT.jar"

===============================================================================================

问题：录制键盘鼠标的输入，转为数据源（我写一大段指令都需要花费半个小时，测试再花费10分钟，40分钟的编写指令操作就为了导入50多条数据...根本没有起到一点加速和方便的作用）
方案：鼠标+键盘事件监听。按键间隔时间。先存入json格式，再转为excel
难点：
1. 组合键如何判断？（已解决）
2. 鼠标拖动，如何模拟？（YiZhi好像都不能实现？？？给出起点和终点，两点之间一条直线？）（解决方案：拖动给手动拆分？？？A--起点坐标；G--shift；A--终点坐标？？？）
3. nativeMouseDragged、nativeMouseWheelMoved，这两个是单独线程监听且持续更新。不太好记录为Events数据呢？（在每次下一个数据输入的时候，如果有数据就加入？）
```text
	1.使用AtomicInteger,记录当前这个两个线程执行的次数。也就是对应的相加次数，即可记录线程执行状态，后续拿状态次数加减即可。
	2.另一个笨办法是每次记录新数据前，判断mouseWheelRecord是否有变化，有就更新。
```

4. 需要记录输入文字吗？（不需要吧...）

解决问题：
1. 开个新线程，用于监听是否进行recordEvents。当满足情况时，可以就可继续record，否则就一直监听？
缺陷和难点中好像大部分都可以用这种方法解决？


缺陷：
1. 上回按下了ctrl+C组合键，如果不松开ctrl键盘按下A，就只能记录A了。即需要注意：每次按下组合键时，需要全部键都松开，下次的组合键才不会出错！(使用队列解决？不行，难点在于如何判断最后的按键。)
2. 双击、三连击无法判断，会识别为两次单击。（解决方案：不使用nativeMouseRelease？直接在clicked里面判断逻辑？）
3. 拖动无法判断。（解决方案：拖动给手动拆分？？？A--起点坐标；G--shift；A--终点坐标？？？）
4. 具体等待时间的判断还是有些问题！
5. 给加一个开始判断呢？
===============================================================================================

===============================================================================================

更多问题：
问题：J -- 图像*有图像执行行数*无图像执行行数
方案：NEXT函数或关键字，以变量代替具体值，指向下一行？

问题：弹出得偶然窗口？应该如何解决？（监听方法）
方案：添加监听层？监听相应的屏幕是否出现对应文字或图片，如果出现，就中断当前的执行顺序临时插入执行一部分命令！不是顺序执行到相应的判断才中断，是把这个变成一个设置选项，方便一键中断！

（可不可以一键设置按键停留时间？）


bug：E ---- *，直接卡着不走了


